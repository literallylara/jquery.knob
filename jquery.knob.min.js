/*! jquery.knob v0.0.3
 * 
 * Copyright (c) 2016 @literallylara
 * Under the MIT license:
 * http://www.opensource.org/licenses/mit-license.php
 */
;(function(c){"function"==typeof define&&define.amd?define(["jquery"],c):"undefined"!==typeof module&&module.exports?module.exports=c:c(window.jQuery||window.$)})(function(c){c.widget("custom.knob",{options:{bgColor:"#000",fgColor:"#fff",type:"vol",tooltip:!0,turnWith:null,arc:360,steps:100,offset:0,min:null,max:null,range:"auto",invertRange:!1,round:!0,fineTuneFactor:10,value:0,resetValue:0,classPrefix:"knob"},_$svg:null,_$stroke:null,_$tooltip:null,_valueNormalized:null,_grabValue:null,_grabOffset:null,
_rangeFine:null,_shiftKey:null,_pageY:null,_create:function(){var b=this,a=this.options;Object.keys(a).forEach(function(c){var d=b.element.attr("data-"+c);a[c]=void 0!==d?d:a[c]});a.min=+a.min||("vol"==a.type?0:-100);a.max=+a.max||100;this._$svg=c('\n\t\t\t<svg class="'+a.classPrefix+'-svg" viewBox="0 0 2 2">\n\t\t\t\t<circle class="'+a.classPrefix+'-stroke" cx="1" cy="1" r="1" clip-path="url(#knob-clip'+this.uuid+')" />\n\t\t\t\t<clipPath id="knob-clip'+this.uuid+'"><circle cx="1" cy="1" r="1" /></clipPath>\n\t\t\t</svg>').appendTo(this.element);
this._$stroke=this._$svg.find("circle:eq(0)").css({fill:a.bgColor,stroke:a.fgColor,strokeWidth:"20%",transformOrigin:"50% 50%"});this._$knob=c('<div class="'+a.classPrefix+'-knob"></div>').css({position:"absolute",top:"50%",left:"50%",zIndex:0,height:"70%",width:"70%",transform:"translate(-50%,-50%)",backgroundColor:a.fgColor,borderRadius:"100%",overflow:"hidden"}).appendTo(this.element);this._$pointerContainer=c('<div class="'+a.classPrefix+'-pointer-container"></div>').css({position:"absolute",
top:"0px",left:"0px",width:"100%",height:"100%",transformOrigin:"50% 50%",zIndex:1}).appendTo(this._$knob);this._$pointer=c('<span class="'+a.classPrefix+'-pointer"></span>').css({position:"absolute",top:"7.5%",left:"50%",height:"15%",width:"7%",transform:"translate(-50%,0%)",backgroundColor:a.bgColor,borderRadius:"2em"}).appendTo(this._$pointerContainer);this._$tooltip=c('<span class="'+a.classPrefix+'-tooltip"></span>').css({position:"absolute",display:"none",zIndex:999,color:"#fff",fontFamily:"monospace",
padding:".25em .5em",borderRadius:"3px",transform:"translate(-50%,-50%)",pointerEvents:"none",backgroundColor:"rgba(0,0,0,.5)"}).appendTo(this.element);a.range="auto"==a.range?this.element.outerHeight()/2:a.range;this._rangeFine=a.range*a.fineTuneFactor;this._setValue(this._normalizeValue(a.value));this.element.css("position","relative");this.element.on("mousedown.knob",this._grab.bind(this));this.element.on("dblclick.knob",this._reset.bind(this))},_clamp:function(b,a,c){return Math.min(Math.max(b,
a),c)},_setValue:function(b){var a=this.options,d="vol"==a.type,f=this._clamp(b,d?0:-1,1),e=a.arc/180*Math.PI/2,g=a.offset-(d?a.arc/2:0),e=d?e*f*2:e*f;this._$stroke.css({strokeDasharray:Math.abs(e)+" "+2*Math.PI,transform:"rotate("+(90+g)+"deg) scale(-1,"+(0<f||d?-1:1)+")"});this._$pointerContainer.css({transform:"rotate("+(e/Math.PI*180+g)+"deg)"});a.turnWith&&c(a.turnWith).css({transform:"rotate("+(e/Math.PI*180+g)+"deg)"});this._valueNormalized=f;this._value=a.min+(a.max-a.min)*this._clamp(d?b:
(b+1)/2,0,1);a.round&&(this._value=Math.round(this._value));this.element.trigger("turn",[this._value,this._valueNormalized])},_grab:function(b){this._grabValue=this._valueNormalized;this._grabOffset=b.pageY;this.element.trigger("grab",[this._value,this._valueNormalized]);c(document).on("mouseup.knob",this._release.bind(this));c(document).on("mousemove.knob",this._turn.bind(this));c(document).on("keyup.knob",this._toggleFineTuning.bind(this));c(document).on("keydown.knob",this._toggleFineTuning.bind(this));
this.element.addClass("grab");this.options.tooltip&&this._updateTooltip(b)},_toggleFineTuning:function(b){b.keyCode&&this._shiftKey!=b.shiftKey&&(this._grabOffset=this._pageY,this._grabValue=this._valueNormalized);this._shiftKey=b.shiftKey},_turn:function(b){b.preventDefault();this._setValue(Math.floor((this._grabValue+(this._grabOffset-b.pageY)/(b.shiftKey?this._rangeFine:this.options.range)*(this.options.invertRange?-1:1))*this.options.steps)/this.options.steps);this._pageY=b.pageY;this.options.tooltip&&
this._updateTooltip(b)},_release:function(b){c(document).off("mouseup.knob mousemove.knob keyup.knob keydown.knob");this.element.trigger("release",[this._value,this._valueNormalized]);this.element.removeClass("grab");this.options.tooltip&&this._$tooltip.hide()},_updateTooltip:function(b){var a="follow"==this.options.tooltip;this._$tooltip.css({top:a?b.pageY-this.element.offset().top:"50%",left:a?b.pageX-this.element.offset().left+40:"50%"}).text(this._value).show()},_reset:function(b){this._setValue(this._normalizeValue(this.options.resetValue));
this.element.trigger("reset",[this._value,this._valueNormalized])},_destroy:function(b){this.element.off("mousedown.knob");this.element.removeClass(this.options.classPrefix+this.uuid);this.element.find("."+this.options.classPrefix+"-style").remove();this.element.find("."+this.options.classPrefix+"-svg").remove();this.element.find("."+this.options.classPrefix+"-knob").remove();this.element.find("."+this.options.classPrefix+"-tooltip").remove()},_normalizeValue:function(b){var a=this.options;b=this._clamp(b,
a.min,a.max);b=(b-a.min)/(a.max-a.min);return b=a.vol?b:2*(b-.5)},value:function(b){if("number"==typeof+b)this._setValue(this._normalizeValue(b));else return this._value}})});